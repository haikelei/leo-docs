import{_ as t,c as e,o as l,N as a}from"./chunks/framework.fc67cb9d.js";const c=JSON.parse('{"title":"","description":"","frontmatter":{},"headers":[],"relativePath":"api/media/audio-context.md","lastUpdated":1685603474000}'),s={name:"api/media/audio-context.md"},n=a(`<h3 id="uni-createinneraudiocontext" tabindex="-1">uni.createInnerAudioContext() <a class="header-anchor" href="#uni-createinneraudiocontext" aria-label="Permalink to &quot;uni.createInnerAudioContext()&quot;">​</a></h3><p>创建并返回内部 audio 上下文 <code>innerAudioContext</code> 对象。</p><p><strong>平台差异说明</strong></p><table><thead><tr><th style="text-align:center;">App</th><th style="text-align:center;">H5</th><th style="text-align:center;">微信小程序</th><th style="text-align:center;">支付宝小程序</th><th style="text-align:center;">百度小程序</th><th style="text-align:center;">字节跳动小程序、飞书小程序</th><th style="text-align:center;">QQ小程序</th><th style="text-align:center;">快手小程序</th><th style="text-align:center;">京东小程序</th></tr></thead><tbody><tr><td style="text-align:center;">√</td><td style="text-align:center;">√</td><td style="text-align:center;">√</td><td style="text-align:center;">1.23.4+</td><td style="text-align:center;">√</td><td style="text-align:center;">√</td><td style="text-align:center;">√</td><td style="text-align:center;">√</td><td style="text-align:center;">√</td></tr></tbody></table><p><strong>innerAudioContext 对象的属性列表</strong></p><table><thead><tr><th style="text-align:left;">属性</th><th style="text-align:left;">类型</th><th style="text-align:left;">说明</th><th style="text-align:left;">只读</th><th style="text-align:left;">平台差异说明</th></tr></thead><tbody><tr><td style="text-align:left;">src</td><td style="text-align:left;">String</td><td style="text-align:left;">音频的数据链接，用于直接播放。</td><td style="text-align:left;">否</td><td style="text-align:left;">微信小程序不支持本地路径</td></tr><tr><td style="text-align:left;">startTime</td><td style="text-align:left;">Number</td><td style="text-align:left;">开始播放的位置（单位：s），默认 0</td><td style="text-align:left;">否</td><td style="text-align:left;"></td></tr><tr><td style="text-align:left;">autoplay</td><td style="text-align:left;">Boolean</td><td style="text-align:left;">是否自动开始播放，默认 false</td><td style="text-align:left;">否</td><td style="text-align:left;">H5端部分浏览器不支持</td></tr><tr><td style="text-align:left;">loop</td><td style="text-align:left;">Boolean</td><td style="text-align:left;">是否循环播放，默认 false</td><td style="text-align:left;">否</td><td style="text-align:left;"></td></tr><tr><td style="text-align:left;">obeyMuteSwitch</td><td style="text-align:left;">Boolean</td><td style="text-align:left;">是否遵循系统静音开关，当此参数为 false 时，即使用户打开了静音开关，也能继续发出声音，默认值 true</td><td style="text-align:left;">否</td><td style="text-align:left;">微信小程序、百度小程序、字节跳动小程序、飞书小程序、京东小程序、快手小程序（仅在 iOS 上生效）</td></tr><tr><td style="text-align:left;">duration</td><td style="text-align:left;">Number</td><td style="text-align:left;">当前音频的长度（单位：s），只有在当前有合法的 src 时返回，需要在onCanplay中获取</td><td style="text-align:left;">是</td><td style="text-align:left;"></td></tr><tr><td style="text-align:left;">currentTime</td><td style="text-align:left;">Number</td><td style="text-align:left;">当前音频的播放位置（单位：s），只有在当前有合法的 src 时返回，时间不取整，保留小数点后 6 位</td><td style="text-align:left;">是</td><td style="text-align:left;"></td></tr><tr><td style="text-align:left;">paused</td><td style="text-align:left;">Boolean</td><td style="text-align:left;">当前是是否暂停或停止状态，true 表示暂停或停止，false 表示正在播放</td><td style="text-align:left;">是</td><td style="text-align:left;"></td></tr><tr><td style="text-align:left;">buffered</td><td style="text-align:left;">Number</td><td style="text-align:left;">音频缓冲的时间点，仅保证当前播放时间点到此时间点内容已缓冲。</td><td style="text-align:left;">是</td><td style="text-align:left;"></td></tr><tr><td style="text-align:left;">volume</td><td style="text-align:left;">Number</td><td style="text-align:left;">音量。范围 0~1。</td><td style="text-align:left;">否</td><td style="text-align:left;"> </td></tr><tr><td style="text-align:left;">sessionCategory</td><td style="text-align:left;">String</td><td style="text-align:left;">设置音频播放模式，可取值：&quot;ambient&quot; - 不中止其他声音播放，不能后台播放，静音后无声音； &quot;soloAmbient&quot; - 中止其他声音播放，不能后台播放，静音后无声音； &quot;playback&quot; - 中止其他声音，可以后台播放，静音后有声音。 默认值为&quot;playback&quot;。</td><td style="text-align:left;">否</td><td style="text-align:left;">App 3.3.7+</td></tr><tr><td style="text-align:left;">playbackRate</td><td style="text-align:left;">Number</td><td style="text-align:left;">播放的倍率。可取值：0.5/0.8/1.0/1.25/1.5/2.0，默认值为1.0</td><td style="text-align:left;">否</td><td style="text-align:left;">App 3.4.5+（Android 需要 6 及以上版本）、微信小程序 2.11.0、支付宝小程序、字节小程序 2.33.0+、快手小程序、百度小程序 3.120.2+</td></tr></tbody></table><p><strong>innerAudioContext 对象的方法列表</strong></p><table><thead><tr><th style="text-align:left;">方法</th><th style="text-align:left;">参数</th><th style="text-align:left;">说明</th><th style="text-align:left;">平台差异说明</th></tr></thead><tbody><tr><td style="text-align:left;">play</td><td style="text-align:left;"></td><td style="text-align:left;">播放（H5端部分浏览器需在用户交互时进行）</td><td style="text-align:left;"></td></tr><tr><td style="text-align:left;">pause</td><td style="text-align:left;"></td><td style="text-align:left;">暂停</td><td style="text-align:left;"></td></tr><tr><td style="text-align:left;">stop</td><td style="text-align:left;"></td><td style="text-align:left;">停止</td><td style="text-align:left;"></td></tr><tr><td style="text-align:left;">seek</td><td style="text-align:left;">position</td><td style="text-align:left;">跳转到指定位置，单位 s</td><td style="text-align:left;"></td></tr><tr><td style="text-align:left;">destroy</td><td style="text-align:left;"></td><td style="text-align:left;">销毁当前实例</td><td style="text-align:left;"></td></tr><tr><td style="text-align:left;">onCanplay</td><td style="text-align:left;">callback</td><td style="text-align:left;">音频进入可以播放状态，但不保证后面可以流畅播放</td><td style="text-align:left;"></td></tr><tr><td style="text-align:left;">onPlay</td><td style="text-align:left;">callback</td><td style="text-align:left;">音频播放事件</td><td style="text-align:left;"></td></tr><tr><td style="text-align:left;">onPause</td><td style="text-align:left;">callback</td><td style="text-align:left;">音频暂停事件</td><td style="text-align:left;"></td></tr><tr><td style="text-align:left;">onStop</td><td style="text-align:left;">callback</td><td style="text-align:left;">音频停止事件</td><td style="text-align:left;"></td></tr><tr><td style="text-align:left;">onEnded</td><td style="text-align:left;">callback</td><td style="text-align:left;">音频自然播放结束事件</td><td style="text-align:left;"></td></tr><tr><td style="text-align:left;">onTimeUpdate</td><td style="text-align:left;">callback</td><td style="text-align:left;">音频播放进度更新事件</td><td style="text-align:left;"></td></tr><tr><td style="text-align:left;">onError</td><td style="text-align:left;">callback</td><td style="text-align:left;">音频播放错误事件</td><td style="text-align:left;"></td></tr><tr><td style="text-align:left;">onWaiting</td><td style="text-align:left;">callback</td><td style="text-align:left;">音频加载中事件，当音频因为数据不足，需要停下来加载时会触发</td><td style="text-align:left;"></td></tr><tr><td style="text-align:left;">onSeeking</td><td style="text-align:left;">callback</td><td style="text-align:left;">音频进行 seek 操作事件</td><td style="text-align:left;"></td></tr><tr><td style="text-align:left;">onSeeked</td><td style="text-align:left;">callback</td><td style="text-align:left;">音频完成 seek 操作事件</td><td style="text-align:left;"></td></tr><tr><td style="text-align:left;">offCanplay</td><td style="text-align:left;">callback</td><td style="text-align:left;">取消监听 onCanplay 事件</td><td style="text-align:left;">微信小程序1.9.0+，支付宝小程序，字节小程序、百度小程序</td></tr><tr><td style="text-align:left;">offPlay</td><td style="text-align:left;">callback</td><td style="text-align:left;">取消监听 onPlay 事件</td><td style="text-align:left;">微信小程序1.9.0+，支付宝小程序，字节小程序、百度小程序</td></tr><tr><td style="text-align:left;">offPause</td><td style="text-align:left;">callback</td><td style="text-align:left;">取消监听 onPause 事件</td><td style="text-align:left;">微信小程序1.9.0+，支付宝小程序，字节小程序、百度小程序</td></tr><tr><td style="text-align:left;">offStop</td><td style="text-align:left;">callback</td><td style="text-align:left;">取消监听 onStop 事件</td><td style="text-align:left;">微信小程序1.9.0+，支付宝小程序，字节小程序、百度小程序</td></tr><tr><td style="text-align:left;">offEnded</td><td style="text-align:left;">callback</td><td style="text-align:left;">取消监听 onEnded 事件</td><td style="text-align:left;">微信小程序1.9.0+，支付宝小程序，字节小程序、百度小程序</td></tr><tr><td style="text-align:left;">offTimeUpdate</td><td style="text-align:left;">callback</td><td style="text-align:left;">取消监听 onTimeUpdate 事件</td><td style="text-align:left;">微信小程序1.9.0+，支付宝小程序，字节小程序、百度小程序</td></tr><tr><td style="text-align:left;">offError</td><td style="text-align:left;">callback</td><td style="text-align:left;">取消监听 onError 事件</td><td style="text-align:left;">微信小程序1.9.0+，支付宝小程序，字节小程序、百度小程序</td></tr><tr><td style="text-align:left;">offWaiting</td><td style="text-align:left;">callback</td><td style="text-align:left;">取消监听 onWaiting 事件</td><td style="text-align:left;">微信小程序1.9.0+，支付宝小程序，字节小程序、百度小程序</td></tr><tr><td style="text-align:left;">offSeeking</td><td style="text-align:left;">callback</td><td style="text-align:left;">取消监听 onSeeking 事件</td><td style="text-align:left;">微信小程序1.9.0+，支付宝小程序，字节小程序、百度小程序</td></tr><tr><td style="text-align:left;">offSeeked</td><td style="text-align:left;">callback</td><td style="text-align:left;">取消监听 onSeeked 事件</td><td style="text-align:left;">微信小程序1.9.0+，支付宝小程序，字节小程序、百度小程序</td></tr></tbody></table><p>errCode 说明</p><table><thead><tr><th style="text-align:left;">errCode</th><th style="text-align:left;">说明</th></tr></thead><tbody><tr><td style="text-align:left;">10001</td><td style="text-align:left;">系统错误</td></tr><tr><td style="text-align:left;">10002</td><td style="text-align:left;">网络错误</td></tr><tr><td style="text-align:left;">10003</td><td style="text-align:left;">文件错误</td></tr><tr><td style="text-align:left;">10004</td><td style="text-align:left;">格式错误</td></tr><tr><td style="text-align:left;">-1</td><td style="text-align:left;">未知错误</td></tr></tbody></table><p><strong>支持格式</strong></p><table><thead><tr><th style="text-align:left;">格式</th><th style="text-align:left;">iOS</th><th style="text-align:left;">Android</th></tr></thead><tbody><tr><td style="text-align:left;">flac</td><td style="text-align:left;">x</td><td style="text-align:left;">√</td></tr><tr><td style="text-align:left;">m4a</td><td style="text-align:left;">√</td><td style="text-align:left;">√</td></tr><tr><td style="text-align:left;">ogg</td><td style="text-align:left;">x</td><td style="text-align:left;">√</td></tr><tr><td style="text-align:left;">ape</td><td style="text-align:left;">x</td><td style="text-align:left;">√</td></tr><tr><td style="text-align:left;">amr</td><td style="text-align:left;">x</td><td style="text-align:left;">√</td></tr><tr><td style="text-align:left;">wma</td><td style="text-align:left;">x</td><td style="text-align:left;">√</td></tr><tr><td style="text-align:left;">wav</td><td style="text-align:left;">√</td><td style="text-align:left;">√</td></tr><tr><td style="text-align:left;">mp3</td><td style="text-align:left;">√</td><td style="text-align:left;">√</td></tr><tr><td style="text-align:left;">mp4</td><td style="text-align:left;">x</td><td style="text-align:left;">√</td></tr><tr><td style="text-align:left;">aac</td><td style="text-align:left;">√</td><td style="text-align:left;">√</td></tr><tr><td style="text-align:left;">aiff</td><td style="text-align:left;">√</td><td style="text-align:left;">x</td></tr><tr><td style="text-align:left;">caf</td><td style="text-align:left;">√</td><td style="text-align:left;">x</td></tr></tbody></table><p><strong>示例</strong></p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> innerAudioContext </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> uni</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">createInnerAudioContext</span><span style="color:#A6ACCD;">()</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">innerAudioContext</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">autoplay </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#FF9CAC;">true</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">innerAudioContext</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">src </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">https://bjetxgzv.cdn.bspapp.com/VKCEYUGU-hello-uniapp/2cc220e0-c27a-11ea-9dfb-6da8e309e0d8.mp3</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">innerAudioContext</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">onPlay</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">开始播放</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">innerAudioContext</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">onError</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">res</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">res</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">errMsg</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">res</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">errCode</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span></code></pre></div><p><strong>tips</strong></p><ul><li>如需音频的倍速播放，可通过video的倍速播放替代实现。插件市场有封装好的插件<a href="https://ext.dcloud.net.cn/search?q=%E9%9F%B3%E9%A2%91%E5%80%8D%E9%80%9F%E6%92%AD%E6%94%BE" target="_blank" rel="noreferrer">音频倍速播放</a></li><li>如果需要带ui的音频播放器样式，可以在插件市场搜索相关<a href="https://ext.dcloud.net.cn/search?q=audio" target="_blank" rel="noreferrer">插件</a></li><li><code>Android 4.1</code> 及更高版本对 <code>PCM/WAVE</code> 支持范围是 <code>8</code> 位和 <code>16</code> 位线性 PCM（比特率最高可达到硬件上限）。以 8000、16000 和 44100 Hz 录制原始 PCM 所需的采样率。</li></ul>`,16),d=[n];function o(i,y,r,g,x,f){return l(),e("div",null,d)}const D=t(s,[["render",o]]);export{c as __pageData,D as default};
