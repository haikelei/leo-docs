import{_ as t,c as s,o as a,N as n}from"./chunks/framework.fc67cb9d.js";const F=JSON.parse('{"title":"","description":"","frontmatter":{},"headers":[],"relativePath":"api/system/ble.md","lastUpdated":1685603474000}'),e={name:"api/system/ble.md"},l=n(`<p><strong>低功耗蓝牙 API 平台差异说明</strong></p><table><thead><tr><th style="text-align:center;">App</th><th style="text-align:center;">H5</th><th style="text-align:center;">微信小程序</th><th style="text-align:center;">支付宝小程序</th><th style="text-align:center;">百度小程序</th><th style="text-align:center;">字节跳动小程序</th><th style="text-align:center;">飞书小程序</th><th style="text-align:center;">QQ小程序</th><th style="text-align:center;">快手小程序</th><th style="text-align:center;">京东小程序</th></tr></thead><tbody><tr><td style="text-align:center;">√</td><td style="text-align:center;">x</td><td style="text-align:center;">√</td><td style="text-align:center;">√</td><td style="text-align:center;">x</td><td style="text-align:center;">x</td><td style="text-align:center;">√</td><td style="text-align:center;">x</td><td style="text-align:center;">x</td><td style="text-align:center;">√</td></tr></tbody></table><h3 id="uni-setblemtu-object" tabindex="-1">uni.setBLEMTU(OBJECT) <a class="header-anchor" href="#uni-setblemtu-object" aria-label="Permalink to &quot;uni.setBLEMTU(OBJECT)&quot;">​</a></h3><p>2.8.4+</p><p>设置蓝牙最大传输单元。需在 uni.createBLEConnection调用成功后调用，mtu 设置范围 (22,512)。安卓5.1以上有效。</p><p><strong>OBJECT 参数说明</strong></p><table><thead><tr><th>属性</th><th>类型</th><th>默认值</th><th>必填</th><th>说明</th></tr></thead><tbody><tr><td>deviceId</td><td>string</td><td></td><td>是</td><td>用于区分设备的 id</td></tr><tr><td>mtu</td><td>number</td><td></td><td>是</td><td>最大传输单元(22,512) 区间内，单位 bytes</td></tr><tr><td>success</td><td>function</td><td></td><td>否</td><td>接口调用成功的回调函数</td></tr><tr><td>fail</td><td>function</td><td></td><td>否</td><td>接口调用失败的回调函数</td></tr><tr><td>complete</td><td>function</td><td></td><td>否</td><td>接口调用结束的回调函数（调用成功、失败都会执行）</td></tr></tbody></table><h3 id="uni-writeblecharacteristicvalue-object" tabindex="-1">uni.writeBLECharacteristicValue(OBJECT) <a class="header-anchor" href="#uni-writeblecharacteristicvalue-object" aria-label="Permalink to &quot;uni.writeBLECharacteristicValue(OBJECT)&quot;">​</a></h3><p>向低功耗蓝牙设备特征值中写入二进制数据。注意：必须设备的特征值支持 write 才可以成功调用。</p><p><strong>OBJECT 参数说明</strong></p><table><thead><tr><th>属性</th><th>类型</th><th>默认值</th><th>必填</th><th>说明</th></tr></thead><tbody><tr><td>deviceId</td><td>string</td><td></td><td>是</td><td>蓝牙设备 id</td></tr><tr><td>serviceId</td><td>string</td><td></td><td>是</td><td>蓝牙特征值对应服务的 uuid</td></tr><tr><td>characteristicId</td><td>string</td><td></td><td>是</td><td>蓝牙特征值的 uuid</td></tr><tr><td>value</td><td>ArrayBuffer</td><td></td><td>是</td><td>蓝牙设备特征值对应的二进制值</td></tr><tr><td>writeType</td><td>string</td><td></td><td>是</td><td>蓝牙特征值的写模式设置，有两种模式，iOS 优先 write，安卓优先 writeNoResponse 。微信小程序支持</td></tr><tr><td>success</td><td>function</td><td></td><td>否</td><td>接口调用成功的回调函数</td></tr><tr><td>fail</td><td>function</td><td></td><td>否</td><td>接口调用失败的回调函数</td></tr><tr><td>complete</td><td>function</td><td></td><td>否</td><td>接口调用结束的回调函数（调用成功、失败都会执行）</td></tr></tbody></table><p><strong>writeType</strong></p><table><thead><tr><th style="text-align:left;">属性</th><th style="text-align:left;">说明</th></tr></thead><tbody><tr><td style="text-align:left;">write</td><td style="text-align:left;">强制回复写，不支持时报错</td></tr><tr><td style="text-align:left;">writeNoResponse</td><td style="text-align:left;">强制无回复写，不支持时报错</td></tr></tbody></table><h4 id="错误" tabindex="-1">错误 <a class="header-anchor" href="#错误" aria-label="Permalink to &quot;错误&quot;">​</a></h4><table><thead><tr><th>错误码</th><th>错误信息</th><th>说明</th></tr></thead><tbody><tr><td>0</td><td>ok</td><td>正常</td></tr><tr><td>10000</td><td>not init</td><td>未初始化蓝牙适配器</td></tr><tr><td>10001</td><td>not available</td><td>当前蓝牙适配器不可用</td></tr><tr><td>10002</td><td>no device</td><td>没有找到指定设备</td></tr><tr><td>10003</td><td>connection fail</td><td>连接失败</td></tr><tr><td>10004</td><td>no service</td><td>没有找到指定服务</td></tr><tr><td>10005</td><td>no characteristic</td><td>没有找到指定特征值</td></tr><tr><td>10006</td><td>no connection</td><td>当前连接已断开</td></tr><tr><td>10007</td><td>property not support</td><td>当前特征值不支持此操作</td></tr><tr><td>10008</td><td>system error</td><td>其余所有系统上报的异常</td></tr><tr><td>10009</td><td>system not support</td><td>Android 系统特有，系统版本低于 4.3 不支持 BLE</td></tr><tr><td>10010</td><td>already connect</td><td>已连接</td></tr><tr><td>10011</td><td>need pin</td><td>配对设备需要配对码</td></tr><tr><td>10012</td><td>operate time out</td><td>连接超时</td></tr><tr><td>10013</td><td>invalid_data</td><td>连接 deviceId 为空或者是格式不正确</td></tr></tbody></table><h4 id="注意" tabindex="-1">注意 <a class="header-anchor" href="#注意" aria-label="Permalink to &quot;注意&quot;">​</a></h4><ul><li>并行调用多次会存在写失败的可能性。</li><li>APP不会对写入数据包大小做限制，但系统与蓝牙设备会限制蓝牙4.0单次传输的数据大小，超过最大字节数后会发生写入错误，建议每次写入不超过20字节。</li><li>若单次写入数据过长，iOS 上存在系统不会有任何回调的情况（包括错误回调）。</li><li>安卓平台上，在调用 <code>notifyBLECharacteristicValueChange</code> 成功后立即调用 <code>writeBLECharacteristicValue</code> 接口，在部分机型上会发生 10008 系统错误</li></ul><h4 id="示例代码" tabindex="-1">示例代码 <a class="header-anchor" href="#示例代码" aria-label="Permalink to &quot;示例代码&quot;">​</a></h4><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">// 向蓝牙设备发送一个0x00的16进制数据</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> buffer </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">ArrayBuffer</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> dataView </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">DataView</span><span style="color:#A6ACCD;">(buffer)</span></span>
<span class="line"><span style="color:#A6ACCD;">dataView</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">setUint8</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">0</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">uni</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">writeBLECharacteristicValue</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// 这里的 deviceId 需要在 getBluetoothDevices 或 onBluetoothDeviceFound 接口中获取</span></span>
<span class="line"><span style="color:#A6ACCD;">  deviceId</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// 这里的 serviceId 需要在 getBLEDeviceServices 接口中获取</span></span>
<span class="line"><span style="color:#A6ACCD;">  serviceId</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// 这里的 characteristicId 需要在 getBLEDeviceCharacteristics 接口中获取</span></span>
<span class="line"><span style="color:#A6ACCD;">  characteristicId</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// 这里的value是ArrayBuffer类型</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">value</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> buffer</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">success</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">res</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">writeBLECharacteristicValue success</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">res</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">errMsg</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span></code></pre></div><h3 id="uni-readblecharacteristicvalue-object" tabindex="-1">uni.readBLECharacteristicValue(OBJECT) <a class="header-anchor" href="#uni-readblecharacteristicvalue-object" aria-label="Permalink to &quot;uni.readBLECharacteristicValue(OBJECT)&quot;">​</a></h3><p>读取低功耗蓝牙设备的特征值的二进制数据值。注意：必须设备的特征值支持 read 才可以成功调用。</p><p><strong>OBJECT 参数说明</strong></p><table><thead><tr><th>属性</th><th>类型</th><th>默认值</th><th>必填</th><th>说明</th></tr></thead><tbody><tr><td>deviceId</td><td>string</td><td></td><td>是</td><td>蓝牙设备 id</td></tr><tr><td>serviceId</td><td>string</td><td></td><td>是</td><td>蓝牙特征值对应服务的 uuid</td></tr><tr><td>characteristicId</td><td>string</td><td></td><td>是</td><td>蓝牙特征值的 uuid</td></tr><tr><td>success</td><td>function</td><td></td><td>否</td><td>接口调用成功的回调函数</td></tr><tr><td>fail</td><td>function</td><td></td><td>否</td><td>接口调用失败的回调函数</td></tr><tr><td>complete</td><td>function</td><td></td><td>否</td><td>接口调用结束的回调函数（调用成功、失败都会执行）</td></tr></tbody></table><h4 id="错误-1" tabindex="-1">错误 <a class="header-anchor" href="#错误-1" aria-label="Permalink to &quot;错误&quot;">​</a></h4><table><thead><tr><th>错误码</th><th>错误信息</th><th>说明</th></tr></thead><tbody><tr><td>0</td><td>ok</td><td>正常</td></tr><tr><td>10000</td><td>not init</td><td>未初始化蓝牙适配器</td></tr><tr><td>10001</td><td>not available</td><td>当前蓝牙适配器不可用</td></tr><tr><td>10002</td><td>no device</td><td>没有找到指定设备</td></tr><tr><td>10003</td><td>connection fail</td><td>连接失败</td></tr><tr><td>10004</td><td>no service</td><td>没有找到指定服务</td></tr><tr><td>10005</td><td>no characteristic</td><td>没有找到指定特征值</td></tr><tr><td>10006</td><td>no connection</td><td>当前连接已断开</td></tr><tr><td>10007</td><td>property not support</td><td>当前特征值不支持此操作</td></tr><tr><td>10008</td><td>system error</td><td>其余所有系统上报的异常</td></tr><tr><td>10009</td><td>system not support</td><td>Android 系统特有，系统版本低于 4.3 不支持 BLE</td></tr><tr><td>10010</td><td>already connect</td><td>已连接</td></tr><tr><td>10011</td><td>need pin</td><td>配对设备需要配对码</td></tr><tr><td>10012</td><td>operate time out</td><td>连接超时</td></tr><tr><td>10013</td><td>invalid_data</td><td>连接 deviceId 为空或者是格式不正确</td></tr></tbody></table><h4 id="注意-1" tabindex="-1">注意 <a class="header-anchor" href="#注意-1" aria-label="Permalink to &quot;注意&quot;">​</a></h4><ul><li>并行调用多次会存在读失败的可能性。</li><li>接口读取到的信息需要在 <code>onBLECharacteristicValueChange</code> 方法注册的回调中获取。</li></ul><h4 id="示例代码-1" tabindex="-1">示例代码 <a class="header-anchor" href="#示例代码-1" aria-label="Permalink to &quot;示例代码&quot;">​</a></h4><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">// 必须在这里的回调才能获取</span></span>
<span class="line"><span style="color:#A6ACCD;">uni</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">onBLECharacteristicValueChange</span><span style="color:#A6ACCD;">(</span><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">characteristic</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">characteristic value comed:</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">characteristic</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">uni</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">readBLECharacteristicValue</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// 这里的 deviceId 需要已经通过 createBLEConnection 与对应设备建立链接</span></span>
<span class="line"><span style="color:#A6ACCD;">  deviceId</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// 这里的 serviceId 需要在 getBLEDeviceServices 接口中获取</span></span>
<span class="line"><span style="color:#A6ACCD;">  serviceId</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// 这里的 characteristicId 需要在 getBLEDeviceCharacteristics 接口中获取</span></span>
<span class="line"><span style="color:#A6ACCD;">  characteristicId</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">success</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">res</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">readBLECharacteristicValue:</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">res</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">errCode</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span></code></pre></div><h3 id="uni-onbleconnectionstatechange-callback" tabindex="-1">uni.onBLEConnectionStateChange(CALLBACK) <a class="header-anchor" href="#uni-onbleconnectionstatechange-callback" aria-label="Permalink to &quot;uni.onBLEConnectionStateChange(CALLBACK)&quot;">​</a></h3><p>监听低功耗蓝牙连接状态的改变事件。包括开发者主动连接或断开连接，设备丢失，连接异常断开等等</p><p><strong>CALLBACK 返回参数</strong></p><table><thead><tr><th>属性</th><th>类型</th><th>说明</th></tr></thead><tbody><tr><td>deviceId</td><td>string</td><td>蓝牙设备ID</td></tr><tr><td>connected</td><td>boolean</td><td>是否处于已连接状态</td></tr></tbody></table><h4 id="示例代码-2" tabindex="-1">示例代码 <a class="header-anchor" href="#示例代码-2" aria-label="Permalink to &quot;示例代码&quot;">​</a></h4><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">uni</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">onBLEConnectionStateChange</span><span style="color:#A6ACCD;">(</span><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">res</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// 该方法回调中可以用于处理连接意外断开等异常情况</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">\`</span><span style="color:#C3E88D;">device </span><span style="color:#89DDFF;">\${</span><span style="color:#A6ACCD;">res</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">deviceId</span><span style="color:#89DDFF;">}</span><span style="color:#C3E88D;"> state has changed, connected: </span><span style="color:#89DDFF;">\${</span><span style="color:#A6ACCD;">res</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">connected</span><span style="color:#89DDFF;">}\`</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span></code></pre></div><h3 id="uni-onblecharacteristicvaluechange-callback" tabindex="-1">uni.onBLECharacteristicValueChange(CALLBACK) <a class="header-anchor" href="#uni-onblecharacteristicvaluechange-callback" aria-label="Permalink to &quot;uni.onBLECharacteristicValueChange(CALLBACK)&quot;">​</a></h3><p>监听低功耗蓝牙设备的特征值变化事件。必须先启用 <code>notifyBLECharacteristicValueChange</code> 接口才能接收到设备推送的 notification。</p><p><strong>CALLBACK 返回参数</strong></p><table><thead><tr><th>属性</th><th>类型</th><th>说明</th></tr></thead><tbody><tr><td>deviceId</td><td>string</td><td>蓝牙设备 id</td></tr><tr><td>serviceId</td><td>string</td><td>蓝牙特征值对应服务的 uuid</td></tr><tr><td>characteristicId</td><td>string</td><td>蓝牙特征值的 uuid</td></tr><tr><td>value</td><td>ArrayBuffer</td><td>特征值最新的值</td></tr></tbody></table><h4 id="示例代码-3" tabindex="-1">示例代码 <a class="header-anchor" href="#示例代码-3" aria-label="Permalink to &quot;示例代码&quot;">​</a></h4><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">// ArrayBuffer转16进度字符串示例</span></span>
<span class="line"><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">ab2hex</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">buffer</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">hexArr</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#FFCB6B;">Array</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">prototype</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">map</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">call</span><span style="color:#F07178;">(</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">new</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">Uint8Array</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">buffer</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">function</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">bit</span><span style="color:#89DDFF;">)</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> (</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">00</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">+</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">bit</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">toString</span><span style="color:#F07178;">(</span><span style="color:#F78C6C;">16</span><span style="color:#F07178;">))</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">slice</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">-</span><span style="color:#F78C6C;">2</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#F07178;">  )</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">hexArr</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">join</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;&#39;</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">uni</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">onBLECharacteristicValueChange</span><span style="color:#A6ACCD;">(</span><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">res</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">\`</span><span style="color:#C3E88D;">characteristic </span><span style="color:#89DDFF;">\${</span><span style="color:#A6ACCD;">res</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">characteristicId</span><span style="color:#89DDFF;">}</span><span style="color:#C3E88D;"> has changed, now is </span><span style="color:#89DDFF;">\${</span><span style="color:#A6ACCD;">res</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">value</span><span style="color:#89DDFF;">}\`</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#82AAFF;">ab2hex</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">res</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">value</span><span style="color:#F07178;">))</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span></code></pre></div><h3 id="uni-notifyblecharacteristicvaluechange-object" tabindex="-1">uni.notifyBLECharacteristicValueChange(OBJECT) <a class="header-anchor" href="#uni-notifyblecharacteristicvaluechange-object" aria-label="Permalink to &quot;uni.notifyBLECharacteristicValueChange(OBJECT)&quot;">​</a></h3><p>启用低功耗蓝牙设备特征值变化时的 notify 功能，订阅特征值。注意：必须设备的特征值支持 notify 或者 indicate 才可以成功调用。 另外，必须先启用 <code>notifyBLECharacteristicValueChange</code> 才能监听到设备 <code>characteristicValueChange</code> 事件</p><p><strong>OBJECT 参数说明</strong></p><table><thead><tr><th>属性</th><th>类型</th><th>默认值</th><th>必填</th><th>说明</th></tr></thead><tbody><tr><td>deviceId</td><td>string</td><td></td><td>是</td><td>蓝牙设备 id</td></tr><tr><td>serviceId</td><td>string</td><td></td><td>是</td><td>蓝牙特征值对应服务的 uuid</td></tr><tr><td>characteristicId</td><td>string</td><td></td><td>是</td><td>蓝牙特征值的 uuid</td></tr><tr><td>state</td><td>boolean</td><td></td><td>是</td><td>是否启用 notify</td></tr><tr><td>success</td><td>function</td><td></td><td>否</td><td>接口调用成功的回调函数</td></tr><tr><td>fail</td><td>function</td><td></td><td>否</td><td>接口调用失败的回调函数</td></tr><tr><td>complete</td><td>function</td><td></td><td>否</td><td>接口调用结束的回调函数（调用成功、失败都会执行）</td></tr></tbody></table><h4 id="错误-2" tabindex="-1">错误 <a class="header-anchor" href="#错误-2" aria-label="Permalink to &quot;错误&quot;">​</a></h4><table><thead><tr><th>错误码</th><th>错误信息</th><th>说明</th></tr></thead><tbody><tr><td>0</td><td>ok</td><td>正常</td></tr><tr><td>10000</td><td>not init</td><td>未初始化蓝牙适配器</td></tr><tr><td>10001</td><td>not available</td><td>当前蓝牙适配器不可用</td></tr><tr><td>10002</td><td>no device</td><td>没有找到指定设备</td></tr><tr><td>10003</td><td>connection fail</td><td>连接失败</td></tr><tr><td>10004</td><td>no service</td><td>没有找到指定服务</td></tr><tr><td>10005</td><td>no characteristic</td><td>没有找到指定特征值</td></tr><tr><td>10006</td><td>no connection</td><td>当前连接已断开</td></tr><tr><td>10007</td><td>property not support</td><td>当前特征值不支持此操作</td></tr><tr><td>10008</td><td>system error</td><td>其余所有系统上报的异常</td></tr><tr><td>10009</td><td>system not support</td><td>Android 系统特有，系统版本低于 4.3 不支持 BLE</td></tr><tr><td>10010</td><td>already connect</td><td>已连接</td></tr><tr><td>10011</td><td>need pin</td><td>配对设备需要配对码</td></tr><tr><td>10012</td><td>operate time out</td><td>连接超时</td></tr><tr><td>10013</td><td>invalid_data</td><td>连接 deviceId 为空或者是格式不正确</td></tr></tbody></table><h4 id="注意-2" tabindex="-1">注意 <a class="header-anchor" href="#注意-2" aria-label="Permalink to &quot;注意&quot;">​</a></h4><ul><li>订阅操作成功后需要设备主动更新特征值的 value，才会触发 <a href="/leo-docs/api/system/ble.html?id=onblecharacteristicvaluechange"><code>uni.onBLECharacteristicValueChange</code></a> 回调。</li><li>安卓平台上，在调用 <code>notifyBLECharacteristicValueChange</code> 成功后立即调用 <code>writeBLECharacteristicValue</code> 接口，在部分机型上会发生 10008 系统错误</li></ul><h4 id="示例代码-4" tabindex="-1">示例代码 <a class="header-anchor" href="#示例代码-4" aria-label="Permalink to &quot;示例代码&quot;">​</a></h4><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">uni</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">notifyBLECharacteristicValueChange</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">state</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FF9CAC;">true</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;font-style:italic;">// 启用 notify 功能</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// 这里的 deviceId 需要已经通过 createBLEConnection 与对应设备建立链接</span></span>
<span class="line"><span style="color:#A6ACCD;">  deviceId</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// 这里的 serviceId 需要在 getBLEDeviceServices 接口中获取</span></span>
<span class="line"><span style="color:#A6ACCD;">  serviceId</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// 这里的 characteristicId 需要在 getBLEDeviceCharacteristics 接口中获取</span></span>
<span class="line"><span style="color:#A6ACCD;">  characteristicId</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">success</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">res</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">notifyBLECharacteristicValueChange success</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">res</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">errMsg</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span></code></pre></div><h3 id="uni-getbledeviceservices-object" tabindex="-1">uni.getBLEDeviceServices(OBJECT) <a class="header-anchor" href="#uni-getbledeviceservices-object" aria-label="Permalink to &quot;uni.getBLEDeviceServices(OBJECT)&quot;">​</a></h3><p>获取蓝牙设备所有服务(service)。</p><p><strong>OBJECT 参数说明</strong></p><table><thead><tr><th>属性</th><th>类型</th><th>默认值</th><th>必填</th><th>说明</th></tr></thead><tbody><tr><td>deviceId</td><td>string</td><td></td><td>是</td><td>蓝牙设备 id</td></tr><tr><td>success</td><td>function</td><td></td><td>否</td><td>接口调用成功的回调函数</td></tr><tr><td>fail</td><td>function</td><td></td><td>否</td><td>接口调用失败的回调函数</td></tr><tr><td>complete</td><td>function</td><td></td><td>否</td><td>接口调用结束的回调函数（调用成功、失败都会执行）</td></tr></tbody></table><p><strong>success 返回参数说明：</strong></p><table><thead><tr><th>属性</th><th>类型</th><th>说明</th></tr></thead><tbody><tr><td>services</td><td>Array&lt;Object&gt;</td><td>设备服务列表</td></tr></tbody></table><p><strong>res.services 的结构</strong></p><table><thead><tr><th>属性</th><th>类型</th><th>说明</th></tr></thead><tbody><tr><td>uuid</td><td>string</td><td>蓝牙设备服务的 uuid</td></tr><tr><td>isPrimary</td><td>boolean</td><td>该服务是否为主服务</td></tr></tbody></table><h4 id="错误-3" tabindex="-1">错误 <a class="header-anchor" href="#错误-3" aria-label="Permalink to &quot;错误&quot;">​</a></h4><table><thead><tr><th>错误码</th><th>错误信息</th><th>说明</th></tr></thead><tbody><tr><td>0</td><td>ok</td><td>正常</td></tr><tr><td>10000</td><td>not init</td><td>未初始化蓝牙适配器</td></tr><tr><td>10001</td><td>not available</td><td>当前蓝牙适配器不可用</td></tr><tr><td>10002</td><td>no device</td><td>没有找到指定设备</td></tr><tr><td>10003</td><td>connection fail</td><td>连接失败</td></tr><tr><td>10004</td><td>no service</td><td>没有找到指定服务</td></tr><tr><td>10005</td><td>no characteristic</td><td>没有找到指定特征值</td></tr><tr><td>10006</td><td>no connection</td><td>当前连接已断开</td></tr><tr><td>10007</td><td>property not support</td><td>当前特征值不支持此操作</td></tr><tr><td>10008</td><td>system error</td><td>其余所有系统上报的异常</td></tr><tr><td>10009</td><td>system not support</td><td>Android 系统特有，系统版本低于 4.3 不支持 BLE</td></tr><tr><td>10010</td><td>already connect</td><td>已连接</td></tr><tr><td>10011</td><td>need pin</td><td>配对设备需要配对码</td></tr><tr><td>10012</td><td>operate time out</td><td>连接超时</td></tr><tr><td>10013</td><td>invalid_data</td><td>连接 deviceId 为空或者是格式不正确</td></tr></tbody></table><h4 id="示例代码-5" tabindex="-1">示例代码 <a class="header-anchor" href="#示例代码-5" aria-label="Permalink to &quot;示例代码&quot;">​</a></h4><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">uni</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getBLEDeviceServices</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// 这里的 deviceId 需要已经通过 createBLEConnection 与对应设备建立链接</span></span>
<span class="line"><span style="color:#A6ACCD;">  deviceId</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">success</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">res</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">device services:</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">res</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">services</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span></code></pre></div><h3 id="uni-getbledevicerssi-object" tabindex="-1">uni.getBLEDeviceRSSI(OBJECT) <a class="header-anchor" href="#uni-getbledevicerssi-object" aria-label="Permalink to &quot;uni.getBLEDeviceRSSI(OBJECT)&quot;">​</a></h3><p>2.8.4+</p><p>获取蓝牙设备的信号强度。</p><p><strong>OBJECT 参数说明</strong></p><table><thead><tr><th>属性</th><th>类型</th><th>默认值</th><th>必填</th><th>说明</th></tr></thead><tbody><tr><td>deviceId</td><td>string</td><td></td><td>是</td><td>蓝牙设备 id</td></tr><tr><td>success</td><td>function</td><td></td><td>否</td><td>接口调用成功的回调函数</td></tr><tr><td>fail</td><td>function</td><td></td><td>否</td><td>接口调用失败的回调函数</td></tr><tr><td>complete</td><td>function</td><td></td><td>否</td><td>接口调用结束的回调函数（调用成功、失败都会执行）</td></tr></tbody></table><h3 id="uni-getbledevicecharacteristics-object" tabindex="-1">uni.getBLEDeviceCharacteristics(OBJECT) <a class="header-anchor" href="#uni-getbledevicecharacteristics-object" aria-label="Permalink to &quot;uni.getBLEDeviceCharacteristics(OBJECT)&quot;">​</a></h3><p>获取蓝牙设备某个服务中所有特征值(characteristic)。</p><p><strong>OBJECT 参数说明</strong></p><table><thead><tr><th>属性</th><th>类型</th><th>默认值</th><th>必填</th><th>说明</th></tr></thead><tbody><tr><td>deviceId</td><td>string</td><td></td><td>是</td><td>蓝牙设备 id</td></tr><tr><td>serviceId</td><td>string</td><td></td><td>是</td><td>蓝牙服务 uuid，需要使用 <code>getBLEDeviceServices</code> 获取</td></tr><tr><td>success</td><td>function</td><td></td><td>否</td><td>接口调用成功的回调函数</td></tr><tr><td>fail</td><td>function</td><td></td><td>否</td><td>接口调用失败的回调函数</td></tr><tr><td>complete</td><td>function</td><td></td><td>否</td><td>接口调用结束的回调函数（调用成功、失败都会执行）</td></tr></tbody></table><p><strong>success 返回参数说明：</strong></p><p>|属性|类型|说明| |---|---|---|---| |characteristics|Array&lt;Object&gt;|设备服务列表|</p><p><strong>res.characteristics 的结构</strong></p><table><thead><tr><th>属性</th><th>类型</th><th>说明</th></tr></thead><tbody><tr><td>uuid</td><td>string</td><td>蓝牙设备特征值的 uuid</td></tr><tr><td>properties</td><td>Object</td><td>该特征值支持的操作类型</td></tr></tbody></table><p><strong>properties 的结构</strong></p><table><thead><tr><th>属性</th><th>类型</th><th>说明</th></tr></thead><tbody><tr><td>read</td><td>boolean</td><td>该特征值是否支持 read 操作</td></tr><tr><td>write</td><td>boolean</td><td>该特征值是否支持 write 操作</td></tr><tr><td>notify</td><td>boolean</td><td>该特征值是否支持 notify 操作</td></tr><tr><td>indicate</td><td>boolean</td><td>该特征值是否支持 indicate 操作</td></tr></tbody></table><h4 id="错误-4" tabindex="-1">错误 <a class="header-anchor" href="#错误-4" aria-label="Permalink to &quot;错误&quot;">​</a></h4><table><thead><tr><th>错误码</th><th>错误信息</th><th>说明</th></tr></thead><tbody><tr><td>0</td><td>ok</td><td>正常</td></tr><tr><td>10000</td><td>not init</td><td>未初始化蓝牙适配器</td></tr><tr><td>10001</td><td>not available</td><td>当前蓝牙适配器不可用</td></tr><tr><td>10002</td><td>no device</td><td>没有找到指定设备</td></tr><tr><td>10003</td><td>connection fail</td><td>连接失败</td></tr><tr><td>10004</td><td>no service</td><td>没有找到指定服务</td></tr><tr><td>10005</td><td>no characteristic</td><td>没有找到指定特征值</td></tr><tr><td>10006</td><td>no connection</td><td>当前连接已断开</td></tr><tr><td>10007</td><td>property not support</td><td>当前特征值不支持此操作</td></tr><tr><td>10008</td><td>system error</td><td>其余所有系统上报的异常</td></tr><tr><td>10009</td><td>system not support</td><td>Android 系统特有，系统版本低于 4.3 不支持 BLE</td></tr></tbody></table><h4 id="示例代码-6" tabindex="-1">示例代码 <a class="header-anchor" href="#示例代码-6" aria-label="Permalink to &quot;示例代码&quot;">​</a></h4><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">uni</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getBLEDeviceCharacteristics</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// 这里的 deviceId 需要已经通过 createBLEConnection 与对应设备建立链接</span></span>
<span class="line"><span style="color:#A6ACCD;">  deviceId</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// 这里的 serviceId 需要在 getBLEDeviceServices 接口中获取</span></span>
<span class="line"><span style="color:#A6ACCD;">  serviceId</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">success</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">res</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">device getBLEDeviceCharacteristics:</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">res</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">characteristics</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span></code></pre></div><h3 id="uni-createbleconnection-object" tabindex="-1">uni.createBLEConnection(OBJECT) <a class="header-anchor" href="#uni-createbleconnection-object" aria-label="Permalink to &quot;uni.createBLEConnection(OBJECT)&quot;">​</a></h3><p>连接低功耗蓝牙设备。</p><p>若APP在之前已有搜索过某个蓝牙设备，并成功建立连接，可直接传入之前搜索获取的 deviceId 直接尝试连接该设备，无需进行搜索操作。</p><p><strong>OBJECT 参数说明</strong></p><table><thead><tr><th>属性</th><th>类型</th><th>默认值</th><th>必填</th><th>说明</th></tr></thead><tbody><tr><td>deviceId</td><td>string</td><td></td><td>是</td><td>用于区分设备的 id</td></tr><tr><td>timeout</td><td>number</td><td></td><td>否</td><td>超时时间，单位ms，不填表示不会超时，京东小程序不支持</td></tr><tr><td>success</td><td>function</td><td></td><td>否</td><td>接口调用成功的回调函数</td></tr><tr><td>fail</td><td>function</td><td></td><td>否</td><td>接口调用失败的回调函数</td></tr><tr><td>complete</td><td>function</td><td></td><td>否</td><td>接口调用结束的回调函数（调用成功、失败都会执行）</td></tr></tbody></table><h4 id="错误-5" tabindex="-1">错误 <a class="header-anchor" href="#错误-5" aria-label="Permalink to &quot;错误&quot;">​</a></h4><table><thead><tr><th>错误码</th><th>错误信息</th><th>说明</th></tr></thead><tbody><tr><td>0</td><td>ok</td><td>正常</td></tr><tr><td>10000</td><td>not init</td><td>未初始化蓝牙适配器</td></tr><tr><td>10001</td><td>not available</td><td>当前蓝牙适配器不可用</td></tr><tr><td>10002</td><td>no device</td><td>没有找到指定设备</td></tr><tr><td>10003</td><td>connection fail</td><td>连接失败</td></tr><tr><td>10004</td><td>no service</td><td>没有找到指定服务</td></tr><tr><td>10005</td><td>no characteristic</td><td>没有找到指定特征值</td></tr><tr><td>10006</td><td>no connection</td><td>当前连接已断开</td></tr><tr><td>10007</td><td>property not support</td><td>当前特征值不支持此操作</td></tr><tr><td>10008</td><td>system error</td><td>其余所有系统上报的异常</td></tr><tr><td>10009</td><td>system not support</td><td>Android 系统特有，系统版本低于 4.3 不支持 BLE</td></tr><tr><td>10010</td><td>already connect</td><td>已连接</td></tr><tr><td>10011</td><td>need pin</td><td>配对设备需要配对码</td></tr><tr><td>10012</td><td>operate time out</td><td>连接超时</td></tr><tr><td>10013</td><td>invalid_data</td><td>连接 deviceId 为空或者是格式不正确</td></tr></tbody></table><h4 id="注意-3" tabindex="-1">注意 <a class="header-anchor" href="#注意-3" aria-label="Permalink to &quot;注意&quot;">​</a></h4><ul><li>请保证尽量成对的调用 <code>createBLEConnection</code> 和 <code>closeBLEConnection</code> 接口。安卓如果多次调用 <code>createBLEConnection</code> 创建连接，有可能导致系统持有同一设备多个连接的实例，导致调用 <code>closeBLEConnection</code> 的时候并不能真正的断开与设备的连接。</li><li>蓝牙连接随时可能断开，建议监听 <a href="/leo-docs/api/system/ble.html?id=onbleconnectionstatechange"><code>uni.onBLEConnectionStateChange</code></a> 回调事件，当蓝牙设备断开时按需执行重连操作</li><li>若对未连接的设备或已断开连接的设备调用数据读写操作的接口，会返回 10006 错误，建议进行重连操作。</li></ul><h4 id="示例代码-7" tabindex="-1">示例代码 <a class="header-anchor" href="#示例代码-7" aria-label="Permalink to &quot;示例代码&quot;">​</a></h4><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">uni</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">createBLEConnection</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// 这里的 deviceId 需要已经通过 createBLEConnection 与对应设备建立链接</span></span>
<span class="line"><span style="color:#A6ACCD;">  deviceId</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">success</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">res</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">res</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span></code></pre></div><h3 id="uni-closebleconnection-object" tabindex="-1">uni.closeBLEConnection(OBJECT) <a class="header-anchor" href="#uni-closebleconnection-object" aria-label="Permalink to &quot;uni.closeBLEConnection(OBJECT)&quot;">​</a></h3><p>断开与低功耗蓝牙设备的连接。</p><p><strong>OBJECT 参数说明</strong></p><table><thead><tr><th>属性</th><th>类型</th><th>默认值</th><th>必填</th><th>说明</th></tr></thead><tbody><tr><td>deviceId</td><td>string</td><td></td><td>是</td><td>用于区分设备的 id</td></tr><tr><td>success</td><td>function</td><td></td><td>否</td><td>接口调用成功的回调函数</td></tr><tr><td>fail</td><td>function</td><td></td><td>否</td><td>接口调用失败的回调函数</td></tr><tr><td>complete</td><td>function</td><td></td><td>否</td><td>接口调用结束的回调函数（调用成功、失败都会执行）</td></tr></tbody></table><h4 id="错误-6" tabindex="-1">错误 <a class="header-anchor" href="#错误-6" aria-label="Permalink to &quot;错误&quot;">​</a></h4><table><thead><tr><th>错误码</th><th>错误信息</th><th>说明</th></tr></thead><tbody><tr><td>0</td><td>ok</td><td>正常</td></tr><tr><td>10000</td><td>not init</td><td>未初始化蓝牙适配器</td></tr><tr><td>10001</td><td>not available</td><td>当前蓝牙适配器不可用</td></tr><tr><td>10002</td><td>no device</td><td>没有找到指定设备</td></tr><tr><td>10003</td><td>connection fail</td><td>连接失败</td></tr><tr><td>10004</td><td>no service</td><td>没有找到指定服务</td></tr><tr><td>10005</td><td>no characteristic</td><td>没有找到指定特征值</td></tr><tr><td>10006</td><td>no connection</td><td>当前连接已断开</td></tr><tr><td>10007</td><td>property not support</td><td>当前特征值不支持此操作</td></tr><tr><td>10008</td><td>system error</td><td>其余所有系统上报的异常</td></tr><tr><td>10009</td><td>system not support</td><td>Android 系统特有，系统版本低于 4.3 不支持 BLE</td></tr><tr><td>10010</td><td>already connect</td><td>已连接</td></tr><tr><td>10011</td><td>need pin</td><td>配对设备需要配对码</td></tr><tr><td>10012</td><td>operate time out</td><td>连接超时</td></tr><tr><td>10013</td><td>invalid_data</td><td>连接 deviceId 为空或者是格式不正确</td></tr></tbody></table><h4 id="示例代码-8" tabindex="-1">示例代码 <a class="header-anchor" href="#示例代码-8" aria-label="Permalink to &quot;示例代码&quot;">​</a></h4><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">uni</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">closeBLEConnection</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  deviceId</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">success</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">res</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">res</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span></code></pre></div>`,101),d=[l];function o(r,p,c,i,y,h){return a(),s("div",null,d)}const C=t(e,[["render",o]]);export{F as __pageData,C as default};
