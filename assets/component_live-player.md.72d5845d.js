import{_ as l,c as n,o as s,N as e,x as t}from"./chunks/framework.fc67cb9d.js";const u=JSON.parse('{"title":"","description":"","frontmatter":{},"headers":[],"relativePath":"component/live-player.md","lastUpdated":1685603474000}'),a={name:"component/live-player.md"},r=e('<h4 id="live-player" tabindex="-1">live-player <a class="header-anchor" href="#live-player" aria-label="Permalink to &quot;live-player&quot;">​</a></h4><p>实时音视频播放，也称直播拉流。</p><p>使用live-player 组件需注意：如果发布到小程序，需要先通过各家小程序的审核。指定类目的小程序才能使用（<a href="https://developers.weixin.qq.com/miniprogram/dev/component/live-player.html" target="_blank" rel="noreferrer">微信小程序类目</a>、<a href="https://smartprogram.baidu.com/docs/develop/component/media/#live-player/" target="_blank" rel="noreferrer">百度小程序类目</a>），审核通过后在各家小程序管理后台自助开通该组件权限。</p><p><strong>平台差异说明</strong></p><table><thead><tr><th style="text-align:center;">App</th><th style="text-align:center;">H5</th><th style="text-align:center;">微信小程序</th><th style="text-align:center;">支付宝小程序</th><th style="text-align:center;">百度小程序</th><th style="text-align:center;">字节跳动小程序</th><th style="text-align:center;">飞书小程序</th><th style="text-align:center;">QQ小程序</th><th style="text-align:center;">快应用</th><th style="text-align:center;">360小程序</th><th style="text-align:center;">京东小程序</th></tr></thead><tbody><tr><td style="text-align:center;">x(见下)</td><td style="text-align:center;">x</td><td style="text-align:center;">√</td><td style="text-align:center;">x</td><td style="text-align:center;">√</td><td style="text-align:center;">√(基础库版本&gt;=1.52.0)</td><td style="text-align:center;">x</td><td style="text-align:center;">√</td><td style="text-align:center;">x</td><td style="text-align:center;">x</td><td style="text-align:center;">x</td></tr></tbody></table><ul><li>App的实时音视频播放，不是使用 live-player，而是直接使用 video 组件。</li><li>H5 下可用 video 播放符合 HTML5 规范的流媒体，rtmp 等非 HTML5 标准的流媒体格式，仅在部分支持 flash 的国内手机浏览器上可播放。在 pc 浏览器上，需要安装 flash 插件才能播放 rtmp 等格式。</li></ul><p><strong>属性说明</strong></p>',7),d=t("table",null,[t("thead",null,[t("tr",null,[t("th",{style:{"text-align":"center"}},"属性名"),t("th",{style:{"text-align":"center"}},"类型"),t("th",{style:{"text-align":"center"}},"默认值"),t("th",{style:{"text-align":"center"}},"说明"),t("th",{style:{"text-align":"center"}},"平台差异说明")])]),t("tbody",null,[t("tr",null,[t("td",{style:{"text-align":"center"}},"id"),t("td",{style:{"text-align":"center"}},"String"),t("td",{style:{"text-align":"center"}}),t("td",{style:{"text-align":"center"}},"live-player 属性的唯一标志符"),t("td",{style:{"text-align":"center"}})]),t("tr",null,[t("td",{style:{"text-align":"center"}},"src"),t("td",{style:{"text-align":"center"}},"String"),t("td",{style:{"text-align":"center"}}),t("td",{style:{"text-align":"center"}},"音视频地址。百度小程序支持 m3u8 格式；微信小程序支持 flv, rtmp 格式"),t("td",{style:{"text-align":"center"}})]),t("tr",null,[t("td",{style:{"text-align":"center"}},"mode"),t("td",{style:{"text-align":"center"}},"String"),t("td",{style:{"text-align":"center"}},"live"),t("td",{style:{"text-align":"center"}},"live（直播），RTC（实时通话，该模式时延更低）"),t("td",{style:{"text-align":"center"}},"微信小程序")]),t("tr",null,[t("td",{style:{"text-align":"center"}},"autoplay"),t("td",{style:{"text-align":"center"}},"Boolean"),t("td",{style:{"text-align":"center"}},"false"),t("td",{style:{"text-align":"center"}},"自动播放"),t("td",{style:{"text-align":"center"}})]),t("tr",null,[t("td",{style:{"text-align":"center"}},"muted"),t("td",{style:{"text-align":"center"}},"Boolean"),t("td",{style:{"text-align":"center"}},"false"),t("td",{style:{"text-align":"center"}},"是否静音"),t("td",{style:{"text-align":"center"}})]),t("tr",null,[t("td",{style:{"text-align":"center"}},"orientation"),t("td",{style:{"text-align":"center"}},"String"),t("td",{style:{"text-align":"center"}},"vertical"),t("td",{style:{"text-align":"center"}},"画面方向，可选值有 vertical，horizontal"),t("td",{style:{"text-align":"center"}})]),t("tr",null,[t("td",{style:{"text-align":"center"}},"object-fit"),t("td",{style:{"text-align":"center"}},"String"),t("td",{style:{"text-align":"center"}},"contain"),t("td",{style:{"text-align":"center"}},"填充模式，可选值:contain、fillCrop"),t("td",{style:{"text-align":"center"}})]),t("tr",null,[t("td",{style:{"text-align":"center"}},"background-mute"),t("td",{style:{"text-align":"center"}},"Boolean"),t("td",{style:{"text-align":"center"}},"false"),t("td",{style:{"text-align":"center"}},"进入后台时是否静音"),t("td",{style:{"text-align":"center"}})]),t("tr",null,[t("td",{style:{"text-align":"center"}},"sound-mode"),t("td",{style:{"text-align":"center"}},"string"),t("td",{style:{"text-align":"center"}},"speaker"),t("td",{style:{"text-align":"center"}},"声音输出方式;可选值speaker、ear"),t("td",{style:{"text-align":"center"}},"微信小程序、QQ小程序1.5.0（仅支持speaker）")]),t("tr",null,[t("td",{style:{"text-align":"center"}},"min-cache"),t("td",{style:{"text-align":"center"}},"Number"),t("td",{style:{"text-align":"center"}},"1"),t("td",{style:{"text-align":"center"}},"最小缓冲区，单位s"),t("td",{style:{"text-align":"center"}})]),t("tr",null,[t("td",{style:{"text-align":"center"}},"max-cache"),t("td",{style:{"text-align":"center"}},"Number"),t("td",{style:{"text-align":"center"}},"3"),t("td",{style:{"text-align":"center"}},"最大缓冲区，单位s"),t("td",{style:{"text-align":"center"}})]),t("tr",null,[t("td",{style:{"text-align":"center"}},"picture-in-picture-mode"),t("td",{style:{"text-align":"center"}},"string/Array"),t("td",{style:{"text-align":"center"}},"3"),t("td",{style:{"text-align":"center"}},'设置小窗模式： push, pop，空字符串或通过数组形式设置多种模式（如： ["push", "pop"]）'),t("td",{style:{"text-align":"center"}},"微信小程序（2.10.3）")]),t("tr",null,[t("td",{style:{"text-align":"center"}},"@statechange"),t("td",{style:{"text-align":"center"}},"EventHandle"),t("td",{style:{"text-align":"center"}}),t("td",{style:{"text-align":"center"},code:""},"播放状态变化事件，detail ="),t("td",{style:{"text-align":"center"}})]),t("tr",null,[t("td",{style:{"text-align":"center"}},"@netstatus"),t("td",{style:{"text-align":"center"}},"EventHandle"),t("td",{style:{"text-align":"center"}}),t("td",{style:{"text-align":"center"},info:""},"网络状态通知，detail ="),t("td",{style:{"text-align":"center"}})]),t("tr",null,[t("td",{style:{"text-align":"center"}},"@fullscreenchange"),t("td",{style:{"text-align":"center"}},"EventHandle"),t("td",{style:{"text-align":"center"}}),t("td",{style:{"text-align":"center"}},"全屏变化事件，detail = {direction, fullScreen}。"),t("td",{style:{"text-align":"center"}}," ")]),t("tr",null,[t("td",{style:{"text-align":"center"}},"@audiovolumenotify"),t("td",{style:{"text-align":"center"}},"EventHandle"),t("td",{style:{"text-align":"center"}}),t("td",{style:{"text-align":"center"}},"播放音量大小通知，detail = {}"),t("td",{style:{"text-align":"center"}},"微信小程序（2.10.0）")]),t("tr",null,[t("td",{style:{"text-align":"center"}},"@enterpictureinpicture"),t("td",{style:{"text-align":"center"}},"EventHandle"),t("td",{style:{"text-align":"center"}}),t("td",{style:{"text-align":"center"}},"播放器进入小窗"),t("td",{style:{"text-align":"center"}},"微信小程序（2.11.0）")]),t("tr",null,[t("td",{style:{"text-align":"center"}},"@leavepictureinpicture"),t("td",{style:{"text-align":"center"}},"EventHandle"),t("td",{style:{"text-align":"center"}}),t("td",{style:{"text-align":"center"}},"播放器退出小窗"),t("td",{style:{"text-align":"center"}},"2.11.0")])])],-1),o=e(`<p>mode 的合法值</p><table><thead><tr><th style="text-align:left;">值</th><th style="text-align:left;">说明</th></tr></thead><tbody><tr><td style="text-align:left;">live</td><td style="text-align:left;">直播</td></tr><tr><td style="text-align:left;">RTC</td><td style="text-align:left;">实时通话，该模式时延更低</td></tr></tbody></table><p>orientation 的合法值</p><table><thead><tr><th style="text-align:left;">值</th><th style="text-align:left;">说明</th></tr></thead><tbody><tr><td style="text-align:left;">vertical</td><td style="text-align:left;">竖直</td></tr><tr><td style="text-align:left;">horizontal</td><td style="text-align:left;">水平</td></tr></tbody></table><p>object-fit 的合法值</p><table><thead><tr><th style="text-align:left;">值</th><th style="text-align:left;">说明</th></tr></thead><tbody><tr><td style="text-align:left;">contain</td><td style="text-align:left;">图像长边填满屏幕，短边区域会被填充⿊⾊</td></tr><tr><td style="text-align:left;">fillCrop</td><td style="text-align:left;">图像铺满屏幕，超出显示区域的部分将被截掉</td></tr></tbody></table><p>sound-mode 的合法值</p><table><thead><tr><th style="text-align:left;">值</th><th style="text-align:left;">说明</th></tr></thead><tbody><tr><td style="text-align:left;">speaker</td><td style="text-align:left;">扬声器</td></tr><tr><td style="text-align:left;">ear</td><td style="text-align:left;">听筒</td></tr></tbody></table><p><strong>Tips</strong></p><ul><li>百度小程序 iOS 端不支持设置 orientation 属性；</li><li>微信小程序已废弃 background-mute 属性，默认为进入后台静音；</li><li>live-player 默认宽度 300px、高度 225px；</li><li>live-player 是原生组件，层级高于前端组件，请勿在 scroll-view、swiper、picker-view、movable-view 中使用</li><li>小程序下覆盖live-player需要使用cover-view。<a href="/leo-docs/component/native-component.html">详见</a></li><li>live-player 组件相关 JS API：<a href="/leo-docs/api/media/live-player-context.html">createLivePlayerContext</a></li><li>小程序平台使用live-player有审核限制，请注意参考各家文档。</li><li>App端使用直播，推荐nvue页面下用video组件，可避免复杂的层级问题和全屏覆盖问题。</li></ul><p><strong>状态码</strong></p><table><thead><tr><th>代码</th><th>说明</th></tr></thead><tbody><tr><td>2001</td><td>已经连接服务器</td></tr><tr><td>2002</td><td>已经连接服务器,开始拉流</td></tr><tr><td>2003</td><td>网络接收到首个视频数据包(IDR)</td></tr><tr><td>2004</td><td>视频播放开始</td></tr><tr><td>2005</td><td>视频播放进度</td></tr><tr><td>2006</td><td>视频播放结束</td></tr><tr><td>2007</td><td>视频播放Loading</td></tr><tr><td>2008</td><td>解码器启动</td></tr><tr><td>2009</td><td>视频分辨率改变</td></tr><tr><td>-2301</td><td>网络断连，且经多次重连抢救无效，更多重试请自行重启播放</td></tr><tr><td>-2302</td><td>获取加速拉流地址失败</td></tr><tr><td>2101</td><td>当前视频帧解码失败</td></tr><tr><td>2102</td><td>当前音频帧解码失败</td></tr><tr><td>2103</td><td>网络断连, 已启动自动重连</td></tr><tr><td>2104</td><td>网络来包不稳：可能是下行带宽不足，或由于主播端出流不均匀</td></tr><tr><td>2105</td><td>当前视频播放出现卡顿</td></tr><tr><td>2106</td><td>硬解启动失败，采用软解</td></tr><tr><td>2107</td><td>当前视频帧不连续，可能丢帧</td></tr><tr><td>2108</td><td>当前流硬解第一个I帧失败，SDK自动切软解</td></tr><tr><td>3001</td><td>RTMP -DNS解析失败</td></tr><tr><td>3002</td><td>RTMP服务器连接失败</td></tr><tr><td>3003</td><td>RTMP服务器握手失败</td></tr><tr><td>3005</td><td>RTMP 读/写失败</td></tr></tbody></table><p><strong>网络状态数据</strong></p><table><thead><tr><th>键名</th><th>说明</th></tr></thead><tbody><tr><td>videoBitrate</td><td>当前视频编/码器输出的比特率，单位 kbps</td></tr><tr><td>audioBitrate</td><td>当前音频编/码器输出的比特率，单位 kbps</td></tr><tr><td>videoFPS</td><td>当前视频帧率</td></tr><tr><td>videoGOP</td><td>当前视频 GOP,也就是每两个关键帧(I帧)间隔时长，单位 s</td></tr><tr><td>netSpeed</td><td>当前的发送/接收速度</td></tr><tr><td>netJitter</td><td>网络抖动情况，抖动越大，网络越不稳定</td></tr><tr><td>videoWidth</td><td>视频画面的宽度</td></tr><tr><td>videoHeight</td><td>视频画面的高度</td></tr></tbody></table><p><strong>示例</strong></p><div class="language-html"><button title="Copy Code" class="copy"></button><span class="lang">html</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">live-player</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#C792EA;">src</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">https://domain/pull_stream</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#C792EA;">autoplay</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#C792EA;">@statechange</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">statechange</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#C792EA;">@error</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">error</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#C792EA;">style</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">width: 300px; height: 225px;</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#89DDFF;">/&gt;</span></span>
<span class="line"></span></code></pre></div><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">default</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">methods</span><span style="color:#89DDFF;">:{</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#F07178;">statechange</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">e</span><span style="color:#89DDFF;">){</span></span>
<span class="line"><span style="color:#F07178;">            </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">live-player code:</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">e</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">detail</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">code</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#F07178;">error</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">e</span><span style="color:#89DDFF;">){</span></span>
<span class="line"><span style="color:#F07178;">            </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">error</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">live-player error:</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">e</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">detail</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">errMsg</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div>`,17),p=[r,d,o];function i(c,y,g,x,h,D){return s(),n("div",null,p)}const v=l(a,[["render",i]]);export{u as __pageData,v as default};
