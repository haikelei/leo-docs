import{_ as t,c as e,o as l,N as s}from"./chunks/framework.fc67cb9d.js";const D=JSON.parse('{"title":"","description":"","frontmatter":{},"headers":[],"relativePath":"api/request/request.md","lastUpdated":1685603474000}'),n={name:"api/request/request.md"},a=s(`<h3 id="uni-request-object" tabindex="-1">uni.request(OBJECT) <a class="header-anchor" href="#uni-request-object" aria-label="Permalink to &quot;uni.request(OBJECT)&quot;">​</a></h3><p>发起网络请求。</p><blockquote><p>在各个小程序平台运行时，网络相关的 API 在使用前需要配置域名白名单。</p></blockquote><p><strong>OBJECT 参数说明</strong></p><table><thead><tr><th style="text-align:left;">参数名</th><th style="text-align:left;">类型</th><th style="text-align:left;">必填</th><th style="text-align:left;">默认值</th><th style="text-align:left;">说明</th><th style="text-align:left;">平台差异说明</th></tr></thead><tbody><tr><td style="text-align:left;">url</td><td style="text-align:left;">String</td><td style="text-align:left;">是</td><td style="text-align:left;"></td><td style="text-align:left;">开发者服务器接口地址</td><td style="text-align:left;"></td></tr><tr><td style="text-align:left;">data</td><td style="text-align:left;">Object/String/ArrayBuffer</td><td style="text-align:left;">否</td><td style="text-align:left;"></td><td style="text-align:left;">请求的参数</td><td style="text-align:left;">App 3.3.7 以下不支持 ArrayBuffer 类型</td></tr><tr><td style="text-align:left;">header</td><td style="text-align:left;">Object</td><td style="text-align:left;">否</td><td style="text-align:left;"></td><td style="text-align:left;">设置请求的 header，header 中不能设置 Referer</td><td style="text-align:left;">App、H5端会自动带上cookie，且H5端不可手动修改</td></tr><tr><td style="text-align:left;">method</td><td style="text-align:left;">String</td><td style="text-align:left;">否</td><td style="text-align:left;">GET</td><td style="text-align:left;">有效值详见下方说明</td><td style="text-align:left;"></td></tr><tr><td style="text-align:left;">timeout</td><td style="text-align:left;">Number</td><td style="text-align:left;">否</td><td style="text-align:left;">60000</td><td style="text-align:left;">超时时间，单位 ms</td><td style="text-align:left;">H5(HBuilderX 2.9.9+)、APP(HBuilderX 2.9.9+)、微信小程序（2.10.0）、支付宝小程序</td></tr><tr><td style="text-align:left;">dataType</td><td style="text-align:left;">String</td><td style="text-align:left;">否</td><td style="text-align:left;">json</td><td style="text-align:left;">如果设为 json，会对返回的数据进行一次 JSON.parse，非 json 不会进行 JSON.parse</td><td style="text-align:left;"></td></tr><tr><td style="text-align:left;">responseType</td><td style="text-align:left;">String</td><td style="text-align:left;">否</td><td style="text-align:left;">text</td><td style="text-align:left;">设置响应的数据类型。合法值：text、arraybuffer</td><td style="text-align:left;">支付宝小程序不支持</td></tr><tr><td style="text-align:left;">sslVerify</td><td style="text-align:left;">Boolean</td><td style="text-align:left;">否</td><td style="text-align:left;">true</td><td style="text-align:left;">验证 ssl 证书</td><td style="text-align:left;">仅App安卓端支持（HBuilderX 2.3.3+），不支持离线打包</td></tr><tr><td style="text-align:left;">withCredentials</td><td style="text-align:left;">Boolean</td><td style="text-align:left;">否</td><td style="text-align:left;">false</td><td style="text-align:left;">跨域请求时是否携带凭证（cookies）</td><td style="text-align:left;">仅H5支持（HBuilderX 2.6.15+）</td></tr><tr><td style="text-align:left;">firstIpv4</td><td style="text-align:left;">Boolean</td><td style="text-align:left;">否</td><td style="text-align:left;">false</td><td style="text-align:left;">DNS解析时优先使用ipv4</td><td style="text-align:left;">仅 App-Android 支持 (HBuilderX 2.8.0+)</td></tr><tr><td style="text-align:left;">enableHttp2</td><td style="text-align:left;">Boolean</td><td style="text-align:left;">否</td><td style="text-align:left;">false</td><td style="text-align:left;">开启 http2</td><td style="text-align:left;">微信小程序</td></tr><tr><td style="text-align:left;">enableQuic</td><td style="text-align:left;">Boolean</td><td style="text-align:left;">否</td><td style="text-align:left;">false</td><td style="text-align:left;">开启 quic</td><td style="text-align:left;">微信小程序</td></tr><tr><td style="text-align:left;">enableCache</td><td style="text-align:left;">Boolean</td><td style="text-align:left;">否</td><td style="text-align:left;">false</td><td style="text-align:left;">开启 cache</td><td style="text-align:left;">微信小程序、字节跳动小程序 2.31.0+</td></tr><tr><td style="text-align:left;">enableHttpDNS</td><td style="text-align:left;">Boolean</td><td style="text-align:left;">否</td><td style="text-align:left;">false</td><td style="text-align:left;">是否开启 HttpDNS 服务。如开启，需要同时填入 httpDNSServiceId 。 HttpDNS 用法详见 <a href="https://developers.weixin.qq.com/miniprogram/dev/framework/ability/HTTPDNS.html" target="_blank" rel="noreferrer">移动解析HttpDNS</a></td><td style="text-align:left;">微信小程序</td></tr><tr><td style="text-align:left;">httpDNSServiceId</td><td style="text-align:left;">String</td><td style="text-align:left;">否</td><td style="text-align:left;"></td><td style="text-align:left;">HttpDNS 服务商 Id。 HttpDNS 用法详见 <a href="https://developers.weixin.qq.com/miniprogram/dev/framework/ability/HTTPDNS.html" target="_blank" rel="noreferrer">移动解析HttpDNS</a></td><td style="text-align:left;">微信小程序</td></tr><tr><td style="text-align:left;">enableChunked</td><td style="text-align:left;">Boolean</td><td style="text-align:left;">否</td><td style="text-align:left;">false</td><td style="text-align:left;">开启 transfer-encoding chunked</td><td style="text-align:left;">微信小程序</td></tr><tr><td style="text-align:left;">forceCellularNetwork</td><td style="text-align:left;">Boolean</td><td style="text-align:left;">否</td><td style="text-align:left;">false</td><td style="text-align:left;">wifi下使用移动网络发送请求</td><td style="text-align:left;">微信小程序</td></tr><tr><td style="text-align:left;">enableCookie</td><td style="text-align:left;">Boolean</td><td style="text-align:left;">否</td><td style="text-align:left;">false</td><td style="text-align:left;">开启后可在headers中编辑cookie</td><td style="text-align:left;">支付宝小程序 10.2.33+</td></tr><tr><td style="text-align:left;">cloudCache</td><td style="text-align:left;">Object/Boolean</td><td style="text-align:left;">否</td><td style="text-align:left;">false</td><td style="text-align:left;">是否开启云加速（详见<a href="https://smartprogram.baidu.com/docs/develop/extended/component-codeless/cloud-speed/introduction/" target="_blank" rel="noreferrer">云加速服务</a>）</td><td style="text-align:left;">百度小程序 3.310.11+</td></tr><tr><td style="text-align:left;">defer</td><td style="text-align:left;">Boolean</td><td style="text-align:left;">否</td><td style="text-align:left;">false</td><td style="text-align:left;">控制当前请求是否延时至首屏内容渲染后发送</td><td style="text-align:left;">百度小程序 3.310.11+</td></tr><tr><td style="text-align:left;">success</td><td style="text-align:left;">Function</td><td style="text-align:left;">否</td><td style="text-align:left;"></td><td style="text-align:left;">收到开发者服务器成功返回的回调函数</td><td style="text-align:left;"></td></tr><tr><td style="text-align:left;">fail</td><td style="text-align:left;">Function</td><td style="text-align:left;">否</td><td style="text-align:left;"></td><td style="text-align:left;">接口调用失败的回调函数</td><td style="text-align:left;"></td></tr><tr><td style="text-align:left;">complete</td><td style="text-align:left;">Function</td><td style="text-align:left;">否</td><td style="text-align:left;"></td><td style="text-align:left;">接口调用结束的回调函数（调用成功、失败都会执行）</td><td style="text-align:left;"> </td></tr></tbody></table><p><strong>method 有效值</strong></p><p>注意：method有效值必须大写，每个平台支持的method有效值不同，详细见下表。</p><table><thead><tr><th style="text-align:center;">method</th><th style="text-align:center;">App</th><th style="text-align:center;">H5</th><th style="text-align:center;">微信小程序</th><th style="text-align:center;">支付宝小程序</th><th style="text-align:center;">百度小程序</th><th style="text-align:center;">字节跳动小程序、飞书小程序</th><th style="text-align:center;">快手小程序</th><th style="text-align:center;">京东小程序</th></tr></thead><tbody><tr><td style="text-align:center;">GET</td><td style="text-align:center;">√</td><td style="text-align:center;">√</td><td style="text-align:center;">√</td><td style="text-align:center;">√</td><td style="text-align:center;">√</td><td style="text-align:center;">√</td><td style="text-align:center;">√</td><td style="text-align:center;">√</td></tr><tr><td style="text-align:center;">POST</td><td style="text-align:center;">√</td><td style="text-align:center;">√</td><td style="text-align:center;">√</td><td style="text-align:center;">√</td><td style="text-align:center;">√</td><td style="text-align:center;">√</td><td style="text-align:center;">√</td><td style="text-align:center;">√</td></tr><tr><td style="text-align:center;">PUT</td><td style="text-align:center;">√</td><td style="text-align:center;">√</td><td style="text-align:center;">√</td><td style="text-align:center;">x</td><td style="text-align:center;">√</td><td style="text-align:center;">√</td><td style="text-align:center;">x</td><td style="text-align:center;">x</td></tr><tr><td style="text-align:center;">DELETE</td><td style="text-align:center;">√</td><td style="text-align:center;">√</td><td style="text-align:center;">√</td><td style="text-align:center;">x</td><td style="text-align:center;">√</td><td style="text-align:center;">x</td><td style="text-align:center;">x</td><td style="text-align:center;">x</td></tr><tr><td style="text-align:center;">CONNECT</td><td style="text-align:center;">x</td><td style="text-align:center;">√</td><td style="text-align:center;">√</td><td style="text-align:center;">x</td><td style="text-align:center;">x</td><td style="text-align:center;">x</td><td style="text-align:center;">x</td><td style="text-align:center;">x</td></tr><tr><td style="text-align:center;">HEAD</td><td style="text-align:center;">√</td><td style="text-align:center;">√</td><td style="text-align:center;">√</td><td style="text-align:center;">x</td><td style="text-align:center;">√</td><td style="text-align:center;">x</td><td style="text-align:center;">x</td><td style="text-align:center;">x</td></tr><tr><td style="text-align:center;">OPTIONS</td><td style="text-align:center;">√</td><td style="text-align:center;">√</td><td style="text-align:center;">√</td><td style="text-align:center;">x</td><td style="text-align:center;">√</td><td style="text-align:center;">x</td><td style="text-align:center;">x</td><td style="text-align:center;">x</td></tr><tr><td style="text-align:center;">TRACE</td><td style="text-align:center;">x</td><td style="text-align:center;">√</td><td style="text-align:center;">√</td><td style="text-align:center;">x</td><td style="text-align:center;">x</td><td style="text-align:center;">x</td><td style="text-align:center;">x</td><td style="text-align:center;">x</td></tr></tbody></table><p><strong>success 返回参数说明</strong></p><table><thead><tr><th style="text-align:left;">参数</th><th style="text-align:left;">类型</th><th style="text-align:left;">说明</th></tr></thead><tbody><tr><td style="text-align:left;">data</td><td style="text-align:left;">Object/String/ArrayBuffer</td><td style="text-align:left;">开发者服务器返回的数据</td></tr><tr><td style="text-align:left;">statusCode</td><td style="text-align:left;">Number</td><td style="text-align:left;">开发者服务器返回的 HTTP 状态码</td></tr><tr><td style="text-align:left;">header</td><td style="text-align:left;">Object</td><td style="text-align:left;">开发者服务器返回的 HTTP Response Header</td></tr><tr><td style="text-align:left;">cookies</td><td style="text-align:left;"><code>Array.&lt;string&gt;</code></td><td style="text-align:left;">开发者服务器返回的 cookies，格式为字符串数组</td></tr></tbody></table><p><strong>data 数据说明</strong></p><p>最终发送给服务器的数据是 String 类型，如果传入的 data 不是 String 类型，会被转换成 String。转换规则如下：</p><ul><li>对于 <code>GET</code> 方法，会将数据转换为 query string。例如 <code>{ name: &#39;name&#39;, age: 18 }</code> 转换后的结果是 <code>name=name&amp;age=18</code>。</li><li>对于 <code>POST</code> 方法且 <code>header[&#39;content-type&#39;]</code> 为 <code>application/json</code> 的数据，会进行 JSON 序列化。</li><li>对于 <code>POST</code> 方法且 <code>header[&#39;content-type&#39;]</code> 为 <code>application/x-www-form-urlencoded</code> 的数据，会将数据转换为 query string。</li></ul><p><strong>示例</strong></p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">uni</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">request</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">url</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">https://www.example.com/request</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;font-style:italic;">//仅为示例，并非真实接口地址。</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">data</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#F07178;">text</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">uni.request</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">header</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">custom-header</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">hello</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;font-style:italic;">//自定义请求头信息</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#82AAFF;">success</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">res</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">res</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">data</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;">this.</span><span style="color:#A6ACCD;">text</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">request success</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span></code></pre></div><p><strong>返回值</strong></p><p>如果希望返回一个 <code>requestTask</code> 对象，需要至少传入 success / fail / complete 参数中的一个。例如：</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">var</span><span style="color:#A6ACCD;"> requestTask </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> uni</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">request</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#F07178;">url</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">https://www.example.com/request</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;font-style:italic;">//仅为示例，并非真实接口地址。</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#82AAFF;">complete</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">()</span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">requestTask</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">abort</span><span style="color:#A6ACCD;">()</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span></code></pre></div><p>如果没有传入 success / fail / complete 参数，则会返回封装后的 Promise 对象：<a href="/leo-docs/api/README.html?id=promise-封装">Promise 封装</a></p><p>通过 <code>requestTask</code>，可中断请求任务。</p><p><strong>requestTask 对象的方法列表</strong></p><table><thead><tr><th style="text-align:left;">方法</th><th style="text-align:left;">参数</th><th style="text-align:left;">说明</th></tr></thead><tbody><tr><td style="text-align:left;">abort</td><td style="text-align:left;"></td><td style="text-align:left;">中断请求任务</td></tr><tr><td style="text-align:left;">offHeadersReceived</td><td style="text-align:left;"></td><td style="text-align:left;">取消监听 HTTP Response Header 事件，仅<code>微信小程序平台</code>支持，<a href="https://developers.weixin.qq.com/miniprogram/dev/api/RequestTask.offHeadersReceived.html" target="_blank" rel="noreferrer">文档详情</a></td></tr><tr><td style="text-align:left;">onHeadersReceived</td><td style="text-align:left;"></td><td style="text-align:left;">监听 HTTP Response Header 事件。会比请求完成事件更早，仅<code>微信小程序平台</code>支持，<a href="https://developers.weixin.qq.com/miniprogram/dev/api/RequestTask.onHeadersReceived.html" target="_blank" rel="noreferrer">文档详情</a></td></tr></tbody></table><p><strong>示例</strong></p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> requestTask </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> uni</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">request</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#F07178;">url</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">https://www.example.com/request</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;font-style:italic;">//仅为示例，并非真实接口地址。</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#F07178;">data</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">name</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#F07178;">age</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">18</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#82AAFF;">success</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">function</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">res</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">		</span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">res</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">data</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">	</span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// 中断请求任务</span></span>
<span class="line"><span style="color:#A6ACCD;">requestTask</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">abort</span><span style="color:#A6ACCD;">()</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span></code></pre></div><p><strong>Tips</strong></p><ul><li>请求的 <code>header</code> 中 <code>content-type</code> 默认为 <code>application/json</code>。</li><li>避免在 <code>header</code> 中使用中文，或者使用 encodeURIComponent 进行编码，否则在百度小程序报错。（来自：<a href="https://juejin.im/user/2612095359650712" target="_blank" rel="noreferrer">快狗打车前端团队</a>）</li><li>网络请求的 <code>超时时间</code> 可以统一在 <code>manifest.json</code> 中配置 <a href="/leo-docs/collocation/manifest.html?id=networktimeout">networkTimeout</a>。</li><li>H5 端本地调试需注意跨域问题，参考：<a href="https://ask.dcloud.net.cn/article/35267" target="_blank" rel="noreferrer">调试跨域问题解决方案</a></li><li>注意由于百度小程序iOS客户端，请求失败时会进入fail回调，需要针对百度增加相应的处理以解决该问题。</li><li>注意小程序端不支持自动保持 cookie，服务器应避免验证 cookie。如果服务器无法修改，也可以使用一些模拟手段，比如这样的工具<a href="https://github.com/charleslo1/weapp-cookie" target="_blank" rel="noreferrer">https://github.com/charleslo1/weapp-cookie</a> 可以请求时带上 cookie 并将响应的 cookie 保存在本地。</li><li>H5端 cookie 受跨域限制（和平时开发网站时一样），旧版的 uni.request 未支持 withCredentials 配置，可以直接使用 xhr 对象或者其他类库。</li><li>根据 W3C 规范，H5 端无法获取 response header 中 Set-Cookie、Set-Cookie2 这2个字段，对于跨域请求，允许获取的 response header 字段只限于“simple response header”和“Access-Control-Expose-Headers”（<a href="https://www.w3.org/TR/cors/#access-control-allow-credentials-response-header" target="_blank" rel="noreferrer">详情</a>）</li><li><a href="https://ext.dcloud.net.cn/search?q=%E6%8B%A6%E6%88%AA%E5%99%A8" target="_blank" rel="noreferrer">uni-app 插件市场</a>有flyio、axios等三方封装的拦截器可用</li><li>低版本手机自身不支持 ipv6，如果服务器仅允许 ipv6，会导致老手机无法正常运行或访问速度非常慢</li><li>localhost、127.0.0.1等服务器地址，只能在电脑端运行，手机端连接时不能访问。请使用标准IP并保证手机能连接电脑网络</li><li>debug 模式，安卓端暂时无法获取响应头，url中含有非法字符（如未编码为%20的空格）时会请求失败</li><li>iOS App第一次安装启动后，会弹出是否允许联网的询问框，在用户点击同意前，调用联网API会失败。请注意判断这种情况。比如官方提供的新闻模板示例（HBuilderX新建项目可选择），会判断如果无法联网，则提供一个错误页，提示用户设置网络及下拉刷新重试。</li><li>良好体验的App，还会判断当前是否处于飞行模式（<a href="https://ext.dcloud.net.cn/plugin?id=594" target="_blank" rel="noreferrer">参考</a>）、是wifi还是3G（<a href="https://uniapp.dcloud.io/api/system/network" target="_blank" rel="noreferrer">参考</a>）</li><li>部分安卓设备，真机运行或debug模式下的网速，低于release模式很多。</li><li>使用一些比较小众的证书机构（如：CFCA OV OCA）签发的 ssl 证书在安卓设备请求会失败，因为这些机构的根证书不在系统内置根证书库，可以更换其他常见机构签发的证书（如：Let&#39;s Encrypt），或者配置 sslVerify 为 false 关闭 ssl 证书验证（不推荐）。</li><li>离线打包不支持 <code>sslVerify</code> 配置</li><li>单次网络请求数据量建议控制在50K以下（仅指json数据，不含图片），过多数据应分页获取，以提升应用体验。</li></ul><h3 id="uni-configmtls-object" tabindex="-1">uni.configMTLS(OBJECT) <a class="header-anchor" href="#uni-configmtls-object" aria-label="Permalink to &quot;uni.configMTLS(OBJECT)&quot;">​</a></h3><p>https 请求配置自签名证书</p><table><thead><tr><th style="text-align:center;">App</th><th style="text-align:center;">H5</th><th style="text-align:center;">微信小程序</th><th style="text-align:center;">支付宝小程序</th><th style="text-align:center;">百度小程序</th><th style="text-align:center;">字节跳动小程序、飞书小程序</th><th style="text-align:center;">QQ小程序</th><th style="text-align:center;">快手小程序</th><th style="text-align:center;">京东小程序</th></tr></thead><tbody><tr><td style="text-align:center;">√<code>(3.2.7+)</code></td><td style="text-align:center;">x</td><td style="text-align:center;">x</td><td style="text-align:center;">x</td><td style="text-align:center;">x</td><td style="text-align:center;">x</td><td style="text-align:center;">x</td><td style="text-align:center;">x</td><td style="text-align:center;">x</td></tr></tbody></table><p><strong>OBJECT 参数说明</strong></p><table><thead><tr><th style="text-align:left;">参数</th><th style="text-align:left;">类型</th><th style="text-align:left;">必填</th><th style="text-align:left;">说明</th></tr></thead><tbody><tr><td style="text-align:left;">certificates</td><td style="text-align:left;">Array&lt;<code>certificate</code>&gt;</td><td style="text-align:left;">是</td><td style="text-align:left;"><code>certificates</code> 为数组，支持为多个域名配置自签名证书</td></tr><tr><td style="text-align:left;">success</td><td style="text-align:left;">Function(<code>callbackObject</code>)</td><td style="text-align:left;">否</td><td style="text-align:left;">接口调用成功的回调函数</td></tr><tr><td style="text-align:left;">fail</td><td style="text-align:left;">Function(<code>callbackObject</code>)</td><td style="text-align:left;">否</td><td style="text-align:left;">接口调用失败的回调函数</td></tr><tr><td style="text-align:left;">complete</td><td style="text-align:left;">Function</td><td style="text-align:left;">否</td><td style="text-align:left;">接口调用结束的回调函数（调用成功、失败都会执行）</td></tr></tbody></table><p><strong>certificate 参数说明</strong> 证书配置项</p><table><thead><tr><th style="text-align:left;">参数</th><th style="text-align:left;">类型</th><th style="text-align:left;">必填</th><th style="text-align:left;">说明</th></tr></thead><tbody><tr><td style="text-align:left;">host</td><td style="text-align:left;">String</td><td style="text-align:left;">是</td><td style="text-align:left;">对应请求的域名（注意：不要协议部分）</td></tr><tr><td style="text-align:left;">client</td><td style="text-align:left;">String</td><td style="text-align:left;">否</td><td style="text-align:left;">客户端证书（服务器端需要验证客户端证书时需要配置此项，格式要求请参考下面的证书格式说明，注意 <code>iOS</code> 平台客户端证书只支持 <code>.p12</code> 类型的证书）</td></tr><tr><td style="text-align:left;">clientPassword</td><td style="text-align:left;">String</td><td style="text-align:left;">否</td><td style="text-align:left;">客户端证书对应的密码（客户端证书存在时必须配置此项）</td></tr><tr><td style="text-align:left;">server</td><td style="text-align:left;">Array&lt;String&gt;</td><td style="text-align:left;">否</td><td style="text-align:left;">服务器端证书（客户端需要对服务器端证书做校验时需要配置此项，格式要求请参考下面的证书格式说明，注意 <code>iOS</code> 平台服务器端证书只支持 <code>.cer</code> 类型的证书）</td></tr></tbody></table><p><strong>证书格式说明</strong></p><ol><li>文件路径形式：可将证书文件放到工程的 ‘static’ 目录中，然后填写文件路径，示例：<code>&#39;/static/client.p12&#39;</code></li><li><code>Base64String</code>：将证书文件的二进制转换为 <code>Base64String</code> 字符串，然后在字符串前面添加<code>&#39;data:cert/pem;base64,&#39;</code>前缀，示例：<code>&#39;data:cert/pem;base64,xxx&#39;</code> xxx 代表真实的证书 base64String</li></ol><p><strong>callbackObject 参数说明</strong></p><table><thead><tr><th style="text-align:left;">属性</th><th style="text-align:left;">类型</th><th style="text-align:left;">说明</th></tr></thead><tbody><tr><td style="text-align:left;">code</td><td style="text-align:left;">Number</td><td style="text-align:left;">成功返回 0,失败返回相应 code 码</td></tr></tbody></table><p><strong>示例</strong></p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">uni</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">configMTLS</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">certificates</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> [</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">host</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">www.test.com</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">client</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/static/client.p12</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">clientPassword</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">123456789</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">server</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> [</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/static/server.cer</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">]</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">]</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">success</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">({</span><span style="color:#A6ACCD;font-style:italic;">code</span><span style="color:#89DDFF;">})</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span></code></pre></div>`,39),o=[a];function r(p,d,c,i,y,g){return l(),e("div",null,o)}const f=t(n,[["render",r]]);export{D as __pageData,f as default};
